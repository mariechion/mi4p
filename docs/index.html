<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple Imputation for Proteomics • mi4p</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Multiple Imputation for Proteomics">
<meta property="og:description" content="A framework for multiple imputation for proteomics is proposed by Marie Chion, Christine Carapito and Frederic Bertrand (2021) &lt;arxiv:2108.07086&gt;. It is dedicated to dealing with multiple imputation for proteomics.">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">mi4p</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Intromi4p.html">Multiple imputation for proteomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mariechion/mi4p/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="mi4p-" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#mi4p-" class="anchor"></a>mi4p
<img src="reference/figures/logo.png" align="right" width="200">
</h1></div>
</div>
<div id="a-multiple-imputation-framework-for-proteomics" class="section level1">
<h1 class="hasAnchor">
<a href="#a-multiple-imputation-framework-for-proteomics" class="anchor"></a>A multiple imputation framework for proteomics</h1>
<div id="marie-chion-christine-carapito-and-frédéric-bertrand" class="section level2">
<h2 class="hasAnchor">
<a href="#marie-chion-christine-carapito-and-fr%C3%A9d%C3%A9ric-bertrand" class="anchor"></a>Marie Chion, Christine Carapito and Frédéric Bertrand</h2>
<!-- badges: start -->

<p>This repository contains the R code and package for the <em>mi4p</em>
methodology (Multiple Imputation for Proteomics), proposed by Marie
Chion, Christine Carapito and Frédéric Bertrand (2021) in <em>Accounting
for multiple imputation-induced variability for differential analysis in
mass spectrometry-based label-free quantitative proteomics</em>, <a href="https://arxiv.org/abs/2108.07086">https://arxiv.org/abs/2108.07086</a>.</p>
<p>The following material is available on the Github repository of the
package <a href="https://github.com/mariechion/mi4p/">https://github.com/mariechion/mi4p/</a>.</p>
<ol>
<li><p>The <code>Functions</code> folder contains all the functions used
for the workflow.</p></li>
<li><p>The <code>Simulation-1</code>, <code>Simulation-2</code> and
<code>Simulation-3</code> folders contain all the R scripts and data
used to conduct simulated experiments and evaluate our
methodology.</p></li>
<li><p>The <code>Arabidopsis_UPS</code> and <code>Yeast_UPS</code>
folders contain all the R scripts and data used to challenge our
methodology on real proteomics datasets. Raw experimental data were
deposited with the ProteomeXchange Consortium via the PRIDE partner
repository with the dataset identifiers PXD003841 and
PXD027800.</p></li>
</ol>
<p>This website and these examples were created by M. Chion, C. Carapito
and F. Bertrand.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of mi4p from <a href="https://CRAN.R-project.org">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"mi4p"</span><span class="op">)</span></code></pre></div>
<p>You can install the development version of mi4p from <a href="https://github.com">github</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"mariechion/mi4p"</span><span class="op">)</span></code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mariechion.github.io/mi4p/">mi4p</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4619</span><span class="op">)</span>
<span class="va">datasim</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/protdatasim.html">protdatasim</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">datasim</span><span class="op">)</span>
<span class="co">#&gt; 'data.frame':    200 obs. of  11 variables:</span>
<span class="co">#&gt;  $ id.obs: int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ X1    : num  99.6 99.9 100.2 99.8 100.4 ...</span>
<span class="co">#&gt;  $ X2    : num  97.4 101.3 100.3 100.2 101.7 ...</span>
<span class="co">#&gt;  $ X3    : num  100.3 100.9 99.1 101.2 100.6 ...</span>
<span class="co">#&gt;  $ X4    : num  99.4 99.2 98.5 99.1 99.5 ...</span>
<span class="co">#&gt;  $ X5    : num  98.5 99.7 100 100.2 100.7 ...</span>
<span class="co">#&gt;  $ X6    : num  200 199 199 200 199 ...</span>
<span class="co">#&gt;  $ X7    : num  200 200 202 199 199 ...</span>
<span class="co">#&gt;  $ X8    : num  202 199 200 199 201 ...</span>
<span class="co">#&gt;  $ X9    : num  200 200 199 201 200 ...</span>
<span class="co">#&gt;  $ X10   : num  200 198 200 201 199 ...</span>
<span class="co">#&gt;  - attr(*, "metadata")='data.frame': 10 obs. of  3 variables:</span>
<span class="co">#&gt;   ..$ Sample.name: chr [1:10] "X1" "X2" "X3" "X4" ...</span>
<span class="co">#&gt;   ..$ Condition  : Factor w/ 2 levels "A","B": 1 1 1 1 1 2 2 2 2 2</span>
<span class="co">#&gt;   ..$ Bio.Rep    : int [1:10] 1 2 3 4 5 6 7 8 9 10</span></code></pre></div>
<p>It is the dataset shipped with package.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">datasim</span>, file<span class="op">=</span><span class="st">"datasim.RData"</span>, compress <span class="op">=</span> <span class="st">"xz"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span>
<span class="co">#&gt;    Sample.name Condition Bio.Rep</span>
<span class="co">#&gt; 1           X1         A       1</span>
<span class="co">#&gt; 2           X2         A       2</span>
<span class="co">#&gt; 3           X3         A       3</span>
<span class="co">#&gt; 4           X4         A       4</span>
<span class="co">#&gt; 5           X5         A       5</span>
<span class="co">#&gt; 6           X6         B       6</span>
<span class="co">#&gt; 7           X7         B       7</span>
<span class="co">#&gt; 8           X8         B       8</span>
<span class="co">#&gt; 9           X9         B       9</span>
<span class="co">#&gt; 10         X10         B      10</span></code></pre></div>
</div>
<div id="amputation" class="section level2">
<h2 class="hasAnchor">
<a href="#amputation" class="anchor"></a>AMPUTATION</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.NA.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/MVgen.html">MVgen</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">datasim</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, prop_NA <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="va">MV1pct.NA.data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,<span class="op">]</span>
<span class="co">#&gt;          X1       X2        X3       X4        X5       X6       X7</span>
<span class="co">#&gt; 1  99.62136  97.3689 100.28075 99.37889  98.48006 200.2803 199.8042</span>
<span class="co">#&gt; 2  99.86342 101.2731 100.86058 99.19046  99.71866 199.2618 200.3934</span>
<span class="co">#&gt; 3 100.21425 100.3024  99.07865 98.51259 100.02675 199.2197 202.2855</span>
<span class="co">#&gt; 4  99.84381 100.2009 101.18119 99.05420 100.18467 200.0615 199.3424</span>
<span class="co">#&gt; 5 100.36412 101.7019 100.59543 99.49536 100.65887 199.2520 199.4715</span>
<span class="co">#&gt; 6 100.70214       NA 101.65048 99.11372 100.94608 201.7471 198.7024</span>
<span class="co">#&gt;         X8       X9      X10</span>
<span class="co">#&gt; 1 201.6095 199.7451 199.7543</span>
<span class="co">#&gt; 2 199.4827 199.7297 198.3984</span>
<span class="co">#&gt; 3 199.7161 198.8883 200.4094</span>
<span class="co">#&gt; 4 199.1865 200.9596 201.2789</span>
<span class="co">#&gt; 5 200.9682 199.9838 198.7303</span>
<span class="co">#&gt; 6 201.8030 199.4030 199.9033</span></code></pre></div>
</div>
<div id="imputation" class="section level2">
<h2 class="hasAnchor">
<a href="#imputation" class="anchor"></a>IMPUTATION</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/multi.impute.html">multi.impute</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MV1pct.NA.data</span>, conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">datasim</span>,<span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span>, method <span class="op">=</span> <span class="st">"MLE"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
</div>
<div id="estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation" class="anchor"></a>ESTIMATION</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Dataset"</span>, <span class="fl">1</span>, <span class="st">"out of"</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "2022-05-11 15:27:11 Dataset 1 out of 1"</span>
<span class="va">MV1pct.impMLE.VarRubin.Mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rubin2.all.html">rubin2.all</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MV1pct.impMLE</span>, metacond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span> </code></pre></div>
</div>
<div id="projection" class="section level2">
<h2 class="hasAnchor">
<a href="#projection" class="anchor"></a>PROJECTION</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Dataset"</span>, <span class="fl">1</span>, <span class="st">"out of"</span>,<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; [1] "Dataset 1 out of 1 2022-05-11 15:28:42"</span>
<span class="va">MV1pct.impMLE.VarRubin.S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span>, <span class="kw">function</span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op">{</span>
    <span class="va">DesMat</span> <span class="op">=</span> <span class="fu">mi4p</span><span class="fu">::</span><span class="fu"><a href="reference/make.design.html">make.design</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op">%*%</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">DesMat</span><span class="op">)</span><span class="op">%*%</span><span class="va">DesMat</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="moderated-t-test" class="section level2">
<h2 class="hasAnchor">
<a href="#moderated-t-test" class="anchor"></a>MODERATED T-TEST</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE.mi4limma.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/mi4limma.html">mi4limma</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, 
                 sTab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span>, 
                 VarRubin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.S2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/rapply.html">rapply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span>,<span class="va">head</span><span class="op">)</span>
<span class="co">#&gt;  logFC.A_vs_B_logFC1  logFC.A_vs_B_logFC2  logFC.A_vs_B_logFC3 </span>
<span class="co">#&gt;           -101.21269            -99.27197           -100.47686 </span>
<span class="co">#&gt;  logFC.A_vs_B_logFC4  logFC.A_vs_B_logFC5  logFC.A_vs_B_logFC6 </span>
<span class="co">#&gt;           -100.07284            -99.11801            -99.82359 </span>
<span class="co">#&gt; P_Value.A_vs_B_pval1 P_Value.A_vs_B_pval2 P_Value.A_vs_B_pval3 </span>
<span class="co">#&gt;              0.00000              0.00000              0.00000 </span>
<span class="co">#&gt; P_Value.A_vs_B_pval4 P_Value.A_vs_B_pval5 P_Value.A_vs_B_pval6 </span>
<span class="co">#&gt;              0.00000              0.00000              0.00000</span>
<span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>
<span class="co">#&gt;  [1] 0 0 0 0 0 0 0 0 0 0</span>

<span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">0.05</span>
<span class="co">#&gt;   [1] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE</span>
<span class="co">#&gt;  [11] FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [21] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [31] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [41] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [51] FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [61] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [71] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [81] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt;  [91] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt; [101] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt; [111]  TRUE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span>
<span class="co">#&gt; [121] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt; [131] FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE</span>
<span class="co">#&gt; [141] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt; [151] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span>
<span class="co">#&gt; [161] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span>
<span class="co">#&gt; [171] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</span>
<span class="co">#&gt; [181] FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></code></pre></div>
<p>True positive rate</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span>
<span class="co">#&gt; [1] 1</span></code></pre></div>
<p>False positive rate</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">/</span><span class="fl">190</span>
<span class="co">#&gt; [1] 0.05789474</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE.dapar.res</span> <span class="op">&lt;-</span><span class="fu"><a href="reference/limmaCompleteTest.mod.html">limmaCompleteTest.mod</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, sTab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/rapply.html">rapply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.dapar.res</span>,<span class="va">head</span><span class="op">)</span>
<span class="co">#&gt;  res.l.logFC.A_vs_B_logFC1  res.l.logFC.A_vs_B_logFC2 </span>
<span class="co">#&gt;                -101.212692                 -99.271966 </span>
<span class="co">#&gt;  res.l.logFC.A_vs_B_logFC3  res.l.logFC.A_vs_B_logFC4 </span>
<span class="co">#&gt;                -100.476863                -100.072843 </span>
<span class="co">#&gt;  res.l.logFC.A_vs_B_logFC5  res.l.logFC.A_vs_B_logFC6 </span>
<span class="co">#&gt;                 -99.118007                 -99.823590 </span>
<span class="co">#&gt; res.l.P_Value.A_vs_B_pval1 res.l.P_Value.A_vs_B_pval2 </span>
<span class="co">#&gt;                   0.000000                   0.000000 </span>
<span class="co">#&gt; res.l.P_Value.A_vs_B_pval3 res.l.P_Value.A_vs_B_pval4 </span>
<span class="co">#&gt;                   0.000000                   0.000000 </span>
<span class="co">#&gt; res.l.P_Value.A_vs_B_pval5 res.l.P_Value.A_vs_B_pval6 </span>
<span class="co">#&gt;                   0.000000                   0.000000 </span>
<span class="co">#&gt;                    fit.s21                    fit.s22 </span>
<span class="co">#&gt;                   1.017841                   1.017841 </span>
<span class="co">#&gt;                    fit.s23                    fit.s24 </span>
<span class="co">#&gt;                   1.017841                   1.017841 </span>
<span class="co">#&gt;                    fit.s25                    fit.s26 </span>
<span class="co">#&gt;                   1.017841                   1.017841</span></code></pre></div>
<p>Simulate a list of 100 datasets.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4619</span><span class="op">)</span>
<span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="va">protdatasim</span><span class="op">)</span>
<span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"metadata"</span><span class="op">)</span></code></pre></div>
<p>It is the list of dataset shipped with package.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span>, file<span class="op">=</span><span class="st">"norm.200.m100.sd1.vs.m200.sd1.list.RData"</span>, compress <span class="op">=</span> <span class="st">"xz"</span><span class="op">)</span></code></pre></div>
<p>100 datasets with parallel comuting support. Quite long to run even
with parallel computing support.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach">foreach</a></span><span class="op">)</span>
<span class="fu">doParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html">registerDoParallel</a></span><span class="op">(</span>cores<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span><span class="op">(</span><span class="st">"foreach"</span>,quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
<div id="amputation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#amputation-1" class="anchor"></a>AMPUTATION</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.NA.data</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span>,
                          .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%dopar%</span> 
  <span class="fu"><a href="reference/MVgen.html">MVgen</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">iforeach</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, prop_NA <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
</div>
<div id="imputation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#imputation-1" class="anchor"></a>IMPUTATION</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="va">MV1pct.NA.data</span>,
                         .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%dopar%</span> 
  <span class="fu"><a href="reference/multi.impute.html">multi.impute</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iforeach</span>, conditions <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Condition</span>, 
               method <span class="op">=</span> <span class="st">"MLE"</span>, parallel  <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
</div>
<div id="estimation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#estimation-1" class="anchor"></a>ESTIMATION</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE.VarRubin.Mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">index</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Dataset"</span>, <span class="va">index</span>, <span class="st">"out of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="reference/rubin2.all.html">rubin2.all</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MV1pct.impMLE</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span>, metacond <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span> 
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="projection-1" class="section level2">
<h2 class="hasAnchor">
<a href="#projection-1" class="anchor"></a>PROJECTION</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE.VarRubin.S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">id.dataset</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Dataset"</span>, <span class="va">id.dataset</span>, <span class="st">"out of"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span><span class="op">[[</span><span class="va">id.dataset</span><span class="op">]</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op">{</span>
    <span class="va">DesMat</span> <span class="op">=</span> <span class="fu">mi4p</span><span class="fu">::</span><span class="fu"><a href="reference/make.design.html">make.design</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span>
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op">%*%</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">DesMat</span><span class="op">)</span><span class="op">%*%</span><span class="va">DesMat</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="moderated-t-test-1" class="section level2">
<h2 class="hasAnchor">
<a href="#moderated-t-test-1" class="anchor"></a>MODERATED T-TEST</h2>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">MV1pct.impMLE.mi4limma.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,  .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%dopar%</span>
  <span class="fu"><a href="reference/mi4limma.html">mi4limma</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">[[</span><span class="va">iforeach</span><span class="op">]</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, 
                 sTab <span class="op">=</span> <span class="va">metadata</span>, 
                 VarRubin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.S2</span><span class="op">[[</span><span class="va">iforeach</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="va">MV1pct.impMLE.dapar.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,  .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%dopar%</span>
  <span class="fu"><a href="reference/limmaCompleteTest.mod.html">limmaCompleteTest.mod</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">[[</span><span class="va">iforeach</span><span class="op">]</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, 
                        sTab <span class="op">=</span> <span class="va">metadata</span><span class="op">)</span></code></pre></div>
<p>Complimentary useful tests</p>
</div>
<div id="testing-for-absencepresence-with-gtest" class="section level2">
<h2 class="hasAnchor">
<a href="#testing-for-absencepresence-with-gtest" class="anchor"></a>TESTING FOR ABSENCE/PRESENCE WITH GTEST</h2>
<p>The <code>g.test</code> function of the<code>ProteoMM</code>
Bioconductor package, implements the G-Test described in “A statistical
framework for protein quantitation in bottom-up MS based proteomics``
(Karpievitch et al. Bioinformatics 2009). For some experimental designs
of experiments, this test may be used to look for significant peptides
based on their absence/presence. For some designs, it will decrease the
precision of out methodology, see the arabidopsis example on github.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ProteoMM</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attachement du package : 'ProteoMM'</span>
<span class="co">#&gt; Les objets suivants sont masqués depuis 'package:mi4p':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     eigen_pi, g.test</span>
<span class="fu">ProteoMM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProteoMM/man/g.test.html">g.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'grp1'</span>, <span class="st">'grp1'</span>, <span class="st">'grp2'</span>, <span class="st">'grp2'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  Log likelihood ratio/G test of independence</span>
<span class="co">#&gt;  without correction</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; data:  c(TRUE, TRUE, FALSE, FALSE) and as.factor(c("grp1", "grp1", "grp2", "grp2"))</span>
<span class="co">#&gt; Log likelihood ratio statistic (G) = 5.5452,</span>
<span class="co">#&gt; X-squared df = 1, p-value = 0.01853</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"qData"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"sTab"</span><span class="op">)</span>
<span class="va">tableNA.qData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">qData</span><span class="op">)</span>,<span class="fl">1</span>,<span class="va">table</span>,<span class="va">sTab</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span>
<span class="va">id.mix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">tableNA.qData</span>,<span class="kw">function</span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="co"># apply(is.na(qData[id.mix,]),1,g.test,sTab$Condition)</span>
<span class="va">res.g.test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>rownames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">qData</span><span class="op">)</span><span class="op">[</span><span class="va">id.mix</span><span class="op">]</span><span class="op">)</span>,
                    p.val<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">qData</span><span class="op">[</span><span class="va">id.mix</span>,<span class="op">]</span><span class="op">)</span>,<span class="fl">1</span>,
                                <span class="kw">function</span><span class="op">(</span><span class="va">tab</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu">ProteoMM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProteoMM/man/g.test.html">g.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tab</span>,y<span class="op">=</span><span class="va">sTab</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">res.g.test</span><span class="op">[</span><span class="va">res.g.test</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0.05</span>,<span class="op">]</span>
<span class="co">#&gt;     rownames(qData)[id.mix]       p.val</span>
<span class="co">#&gt; 29                       29 0.003925917</span>
<span class="co">#&gt; 44                       44 0.003925917</span>
<span class="co">#&gt; 105                     105 0.003925917</span>
<span class="co">#&gt; 389                     389 0.003925917</span>
<span class="va">qData</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">res.g.test</span><span class="op">[</span><span class="va">res.g.test</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">&lt;</span><span class="fl">0.05</span>,<span class="op">]</span><span class="op">)</span>,<span class="op">]</span>
<span class="co">#&gt;     Intensity_C_R1 Intensity_C_R2 Intensity_C_R3</span>
<span class="co">#&gt; 29        23.18826       22.74154       22.94633</span>
<span class="co">#&gt; 44              NA             NA             NA</span>
<span class="co">#&gt; 105       26.52709       26.37171       26.63201</span>
<span class="co">#&gt; 389             NA             NA             NA</span>
<span class="co">#&gt;     Intensity_D_R1 Intensity_D_R2 Intensity_D_R3</span>
<span class="co">#&gt; 29              NA             NA             NA</span>
<span class="co">#&gt; 44        25.83019       25.98796       26.03095</span>
<span class="co">#&gt; 105             NA             NA             NA</span>
<span class="co">#&gt; 389       22.20932       21.93693       22.03093</span></code></pre></div>
<p>The <code>eigen_pi</code> function of the <code>ProteoMM</code>
Bioconductor package computes the proportion of observations missing
completely at random. It is used by the <code>g.test</code> function if
such an estimate is to be computed using the data .</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">ProteoMM</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">mm_peptides</span><span class="op">)</span>
<span class="va">intsCols</span> <span class="op">=</span> <span class="fl">8</span><span class="op">:</span><span class="fl">13</span>
<span class="va">metaCols</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>
<span class="va">m_Ints</span> <span class="op">=</span> <span class="va">mm_peptides</span><span class="op">[</span>, <span class="va">intsCols</span><span class="op">]</span>
<span class="va">m_prot.info</span> <span class="op">=</span> <span class="va">mm_peptides</span><span class="op">[</span>, <span class="va">metaCols</span><span class="op">]</span>
<span class="va">m_logInts</span> <span class="op">=</span> <span class="va">m_Ints</span>
<span class="va">m_logInts</span><span class="op">[</span><span class="va">m_Ints</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span> <span class="op">=</span> <span class="cn">NA</span>
<span class="va">m_logInts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log2</a></span><span class="op">(</span><span class="va">m_logInts</span><span class="op">)</span>
<span class="va">my.pi</span> <span class="op">=</span> <span class="fu">ProteoMM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ProteoMM/man/eigen_pi.html">eigen_pi</a></span><span class="op">(</span><span class="va">m_logInts</span>, toplot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-24-1.png" title="plot of chunk unnamed-chunk-24" alt="plot of chunk unnamed-chunk-24" width="100%"></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=mi4p">https://​cloud.r-project.org/​package=mi4p</a>
</li>
<li>Browse source code at <br><a href="https://github.com/mariechion/mi4p/">https://​github.com/​mariechion/​mi4p/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/mariechion/mi4p/issues/">https://​github.com/​mariechion/​mi4p/​issues/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing mi4p</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Marie Chion <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-8956-8388" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Christine Carapito <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-0079-319X" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Frederic Bertrand <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-0837-8281" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html"><img src="https://img.shields.io/badge/lifecycle-stable-green.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://www.repostatus.org/#active"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active – The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/mariechion/mi4p/actions"><img src="https://github.com/mariechion/mi4p/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=mi4p"><img src="https://www.r-pkg.org/badges/version/mi4p" alt="CRAN status"></a></li>
<li><a href="https://cran.r-project.org/package=mi4p"><img src="https://cranlogs.r-pkg.org/badges/mi4p" alt="CRAN RStudio mirror downloads"></a></li>
<li><a href="https://github.com/mariechion/mi4p"><img src="https://img.shields.io/github/stars/mariechion/mi4p?style=social" alt="GitHub Repo stars"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Marie Chion, Christine Carapito, Frederic Bertrand.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
