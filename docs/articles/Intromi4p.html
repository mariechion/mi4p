<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multiple imputation for proteomics • mi4p</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multiple imputation for proteomics">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mi4p</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Intromi4p.html">Multiple imputation for proteomics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mariechion/mi4p/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Multiple imputation for proteomics</h1>
                        <h4 data-toc-skip class="author">Marie Chion,
Université de Strasbourg et CNRS, IRMA, labex IRMIA, LSMBO, IPHC, <a href="mailto:marie.chion@protonmail.fr" class="email">marie.chion@protonmail.fr</a>
</h4>
                        <h4 data-toc-skip class="author">Christine
Carapito, Université de Strasbourg et CNRS, LSMBO, IPHC, <a href="mailto:ccarapito@unistra.fr" class="email">ccarapito@unistra.fr</a>
</h4>
                        <h4 data-toc-skip class="author">Frédéric
Bertrand, Université de Strasbourg et CNRS, IRMA, labex IRMIA,
Université de technologie de Troyes, LIST3N, <a href="mailto:frederic.bertrand@utt.fr" class="email">frederic.bertrand@utt.fr</a>
</h4>
            
            <h4 data-toc-skip class="date">2024-10-01</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/mariechion/mi4p/blob/HEAD/vignettes/Intromi4p.Rmd" class="external-link"><code>vignettes/Intromi4p.Rmd</code></a></small>
      <div class="hidden name"><code>Intromi4p.Rmd</code></div>

    </div>

    
    
<table align="center" class="table"><tr>
<td>
<img src="../reference/figures/logo.png" align="center" width="200" style="margin:0 0 0 100px;">
</td>
</tr></table>
<div class="section level2">
<h2 id="mi4p-multiple-imputation-for-proteomics">mi4p: multiple imputation for proteomics<a class="anchor" aria-label="anchor" href="#mi4p-multiple-imputation-for-proteomics"></a>
</h2>
<p>This repository contains the R code and package for the <em>mi4p</em>
methodology (Multiple Imputation for Proteomics), proposed by Marie
Chion, Christine Carapito and Frédéric Bertrand (2021) in <em>Accounting
for multiple imputation-induced variability for differential analysis in
mass spectrometry-based label-free quantitative proteomics</em>, <a href="https://arxiv.org/abs/2108.07086" class="external-link">https://arxiv.org/abs/2108.07086</a>.</p>
<p>The following material is available on the Github repository of the
package <a href="https://github.com/mariechion/mi4p/" class="external-link">https://github.com/mariechion/mi4p/</a>.</p>
<ol style="list-style-type: decimal">
<li><p>The <code>Functions</code> folder contains all the functions used
for the workflow.</p></li>
<li><p>The <code>Simulation-1</code>, <code>Simulation-2</code> and
<code>Simulation-3</code> folders contain all the R scripts and data
used to conduct simulated experiments and evaluate our
methodology.</p></li>
<li><p>The <code>Arabidopsis_UPS</code> and <code>Yeast_UPS</code>
folders contain all the R scripts and data used to challenge our
methodology on real proteomics datasets. Raw experimental data were
deposited with the ProteomeXchange Consortium via the PRIDE partner
repository with the dataset identifiers PXD003841 and
PXD027800.</p></li>
</ol>
<!--You can insert a graphic here, just modify that syntax  ![Example Graphs.](IntroPatterns_files/figure-html/Fresults-1.png) --><p>This website and these examples were created by M. Chion, C. Carapito
and F. Bertrand.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>You can install the released version of mi4p from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"mi4p"</span><span class="op">)</span></span></code></pre></div>
<p>You can install the development version of mi4p from <a href="https://github.com" class="external-link">github</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mariechion/mi4p"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h3>
<div class="section level4">
<h4 id="first-section">First section<a class="anchor" aria-label="anchor" href="#first-section"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mariechion.github.io/mi4p/" class="external-link">mi4p</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4619</span><span class="op">)</span></span>
<span><span class="va">datasim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/protdatasim.html">protdatasim</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">datasim</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    200 obs. of  11 variables:</span></span>
<span><span class="co">#&gt;  $ id.obs: int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ X1    : num  99.6 99.9 100.2 99.8 100.4 ...</span></span>
<span><span class="co">#&gt;  $ X2    : num  97.4 101.3 100.3 100.2 101.7 ...</span></span>
<span><span class="co">#&gt;  $ X3    : num  100.3 100.9 99.1 101.2 100.6 ...</span></span>
<span><span class="co">#&gt;  $ X4    : num  99.4 99.2 98.5 99.1 99.5 ...</span></span>
<span><span class="co">#&gt;  $ X5    : num  98.5 99.7 100 100.2 100.7 ...</span></span>
<span><span class="co">#&gt;  $ X6    : num  200 199 199 200 199 ...</span></span>
<span><span class="co">#&gt;  $ X7    : num  200 200 202 199 199 ...</span></span>
<span><span class="co">#&gt;  $ X8    : num  202 199 200 199 201 ...</span></span>
<span><span class="co">#&gt;  $ X9    : num  200 200 199 201 200 ...</span></span>
<span><span class="co">#&gt;  $ X10   : num  200 198 200 201 199 ...</span></span>
<span><span class="co">#&gt;  - attr(*, "metadata")='data.frame': 10 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;   ..$ Sample.name: chr [1:10] "X1" "X2" "X3" "X4" ...</span></span>
<span><span class="co">#&gt;   ..$ Condition  : Factor w/ 2 levels "A","B": 1 1 1 1 1 2 2 2 2 2</span></span>
<span><span class="co">#&gt;   ..$ Bio.Rep    : int [1:10] 1 2 3 4 5 6 7 8 9 10</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Sample.name Condition Bio.Rep</span></span>
<span><span class="co">#&gt; 1           X1         A       1</span></span>
<span><span class="co">#&gt; 2           X2         A       2</span></span>
<span><span class="co">#&gt; 3           X3         A       3</span></span>
<span><span class="co">#&gt; 4           X4         A       4</span></span>
<span><span class="co">#&gt; 5           X5         A       5</span></span>
<span><span class="co">#&gt; 6           X6         B       6</span></span>
<span><span class="co">#&gt; 7           X7         B       7</span></span>
<span><span class="co">#&gt; 8           X8         B       8</span></span>
<span><span class="co">#&gt; 9           X9         B       9</span></span>
<span><span class="co">#&gt; 10         X10         B      10</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="amputation">AMPUTATION<a class="anchor" aria-label="anchor" href="#amputation"></a>
</h3>
<!-- Use `eval=LOCAL` to prevent testing too long computation during CRAN checks.-->
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.NA.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MVgen.html">MVgen</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">datasim</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, prop_NA <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span>
<span><span class="va">MV1pct.NA.data</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="imputation">IMPUTATION<a class="anchor" aria-label="anchor" href="#imputation"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multi.impute.html">multi.impute</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MV1pct.NA.data</span>, conditions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">datasim</span>,<span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span>, method <span class="op">=</span> <span class="st">"MLE"</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimation">ESTIMATION<a class="anchor" aria-label="anchor" href="#estimation"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Dataset"</span>, <span class="fl">1</span>, <span class="st">"out of"</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MV1pct.impMLE.VarRubin.Mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rubin2.all.html">rubin2.all</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MV1pct.impMLE</span>, metacond <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="projection">PROJECTION<a class="anchor" aria-label="anchor" href="#projection"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Dataset"</span>, <span class="fl">1</span>, <span class="st">"out of"</span>,<span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MV1pct.impMLE.VarRubin.S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span>, <span class="kw">function</span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">DesMat</span> <span class="op">=</span> <span class="fu">mi4p</span><span class="fu">::</span><span class="fu"><a href="../reference/make.design.html">make.design</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DesMat</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">DesMat</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="moderated-t-test">MODERATED T-TEST<a class="anchor" aria-label="anchor" href="#moderated-t-test"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE.mi4limma.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mi4limma.html">mi4limma</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, </span>
<span>                 sTab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span>, </span>
<span>                 VarRubin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.S2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MV1pct.impMLE.mi4limma.res</span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span>
<span></span>
<span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">0.05</span></span></code></pre></div>
<p>True positive rate</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">/</span><span class="fl">10</span></span></code></pre></div>
<p>False positive rate</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">simplify2array</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.mi4limma.res</span><span class="op">)</span><span class="op">$</span><span class="va">P_Value.A_vs_B_pval</span><span class="op">)</span><span class="op">[</span><span class="fl">11</span><span class="op">:</span><span class="fl">200</span><span class="op">]</span><span class="op">&lt;=</span><span class="fl">0.05</span><span class="op">)</span><span class="op">/</span><span class="fl">190</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE.dapar.res</span> <span class="op">&lt;-</span><span class="fu"><a href="../reference/limmaCompleteTest.mod.html">limmaCompleteTest.mod</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, sTab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">datasim</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MV1pct.impMLE.dapar.res</span></span></code></pre></div>
<p>Simulate a list of 100 datasets.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4619</span><span class="op">)</span></span>
<span><span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="va">protdatasim</span><span class="op">)</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"metadata"</span><span class="op">)</span></span></code></pre></div>
<p>100 datasets with parallel comuting support. Quite long to run even
with parallel computing support.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/foreach" class="external-link">foreach</a></span><span class="op">)</span></span>
<span><span class="fu">doParallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span>cores<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"foreach"</span>,quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="amputation-1">AMPUTATION<a class="anchor" aria-label="anchor" href="#amputation-1"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.NA.data</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="va">norm.200.m100.sd1.vs.m200.sd1.list</span>,</span>
<span>                          .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> </span>
<span>  <span class="fu"><a href="../reference/MVgen.html">MVgen</a></span><span class="op">(</span>dataset <span class="op">=</span> <span class="va">iforeach</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>, prop_NA <span class="op">=</span> <span class="fl">0.01</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="imputation-1">IMPUTATION<a class="anchor" aria-label="anchor" href="#imputation-1"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE</span> <span class="op">&lt;-</span> <span class="fu">foreach</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="va">MV1pct.NA.data</span>,</span>
<span>                         .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> </span>
<span>  <span class="fu"><a href="../reference/multi.impute.html">multi.impute</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">iforeach</span>, conditions <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Condition</span>, </span>
<span>               method <span class="op">=</span> <span class="st">"MLE"</span>, parallel  <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="estimation-1">ESTIMATION<a class="anchor" aria-label="anchor" href="#estimation-1"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE.VarRubin.Mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">index</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"Dataset"</span>, <span class="va">index</span>, <span class="st">"out of"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="../reference/rubin2.all.html">rubin2.all</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">MV1pct.impMLE</span><span class="op">[[</span><span class="va">index</span><span class="op">]</span><span class="op">]</span>, metacond <span class="op">=</span> <span class="va">metadata</span><span class="op">$</span><span class="va">Condition</span><span class="op">)</span> </span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="projection-1">PROJECTION<a class="anchor" aria-label="anchor" href="#projection-1"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE.VarRubin.S2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">id.dataset</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Dataset"</span>, <span class="va">id.dataset</span>, <span class="st">"out of"</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.Mat</span><span class="op">[[</span><span class="va">id.dataset</span><span class="op">]</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">DesMat</span> <span class="op">=</span> <span class="fu">mi4p</span><span class="fu">::</span><span class="fu"><a href="../reference/make.design.html">make.design</a></span><span class="op">(</span><span class="va">metadata</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">aaa</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">DesMat</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">DesMat</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="moderated-t-test-1">MODERATED T-TEST<a class="anchor" aria-label="anchor" href="#moderated-t-test-1"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MV1pct.impMLE.mi4limma.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,  .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span></span>
<span>  <span class="fu"><a href="../reference/mi4limma.html">mi4limma</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">[[</span><span class="va">iforeach</span><span class="op">]</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, </span>
<span>                 sTab <span class="op">=</span> <span class="va">metadata</span>, </span>
<span>                 VarRubin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">MV1pct.impMLE.VarRubin.S2</span><span class="op">[[</span><span class="va">iforeach</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">MV1pct.impMLE.dapar.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>iforeach <span class="op">=</span>  <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,  .errorhandling <span class="op">=</span> <span class="st">'stop'</span>, .verbose <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span></span>
<span>  <span class="fu"><a href="../reference/limmaCompleteTest.mod.html">limmaCompleteTest.mod</a></span><span class="op">(</span>qData <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">MV1pct.impMLE</span><span class="op">[[</span><span class="va">iforeach</span><span class="op">]</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,<span class="va">mean</span><span class="op">)</span>, </span>
<span>                        sTab <span class="op">=</span> <span class="va">metadata</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Marie Chion, Christine Carapito, Frederic Bertrand.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
